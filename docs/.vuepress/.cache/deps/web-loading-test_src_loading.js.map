{
  "version": 3,
  "sources": ["../../../../node_modules/web-loading-test/src/utils.ts", "../../../../node_modules/web-loading-test/src/draw/index.ts", "../../../../node_modules/web-loading-test/src/Webloading/style.ts", "../../../../node_modules/web-loading-test/src/Webloading/index.ts", "../../../../node_modules/web-loading-test/src/loading.ts"],
  "sourcesContent": ["import { LogConfigType, OptionsType } from './types'\r\n\r\n/**\r\n * 支持的 loading 方式\r\n */\r\nexport enum LOADING_TYPES {\r\n  FULL = 'Full',\r\n  MINI = 'mini',\r\n  DOM = 'dom'\r\n}\r\n/**\r\n * 支持的 model\r\n */\r\nexport enum MODEL_TYPES {\r\n  GEAR = 'Gear',\r\n  RING = 'Ring',\r\n  Zoom = 'Zoom',\r\n  PATTERN = 'Pattern',\r\n  CLOCK = 'Clock',\r\n  BEAN = 'Bean',\r\n  ROLL = 'Roll',\r\n  IMG = 'Img',\r\n  SKELETON = 'Skeleton'\r\n}\r\n/**\r\n *\r\n * @returns 返回默认配置\r\n */\r\nexport function getDefOptions(): Required<OptionsType> {\r\n  return {\r\n    custom: null,\r\n    type: LOADING_TYPES.DOM,\r\n    model: MODEL_TYPES.RING,\r\n    miniClass: 'mini',\r\n    delayColse: 520,\r\n    optimization: false,\r\n    zIndex: '2001',\r\n    themeColor: 'rgba(64,158,255,1)',\r\n    bgColor: 'rgba(0, 0, 0, 0.8)',\r\n    shadowColor: 'rgba(64,158,255,0.6)',\r\n    shadowOffsetX: 2,\r\n    shadowOffsetY: 2,\r\n    shadowBlur: 5,\r\n    pointerEvents: false,\r\n    delay: 65,\r\n    text: '加载中...',\r\n    textGap: 8,\r\n    fontSize: 12,\r\n    fontFamily: 'Microsoft YaHei'\r\n  }\r\n}\r\nexport enum LOG_TYPES {\r\n  INFO = 1,\r\n  WARN = 2,\r\n  ERROR = 3\r\n}\r\n/**\r\n * 日志输出\r\n * @param message 内容\r\n * @param config 配置\r\n */\r\nexport class $Log {\r\n  static info(message: string) {\r\n    this.call(message, LOG_TYPES.INFO)\r\n  }\r\n  static warn(message: string) {\r\n    this.call(message, LOG_TYPES.WARN)\r\n  }\r\n  static error(message: string) {\r\n    this.call(message, LOG_TYPES.ERROR)\r\n  }\r\n  static call(\r\n    message: string,\r\n    type: LOG_TYPES = LOG_TYPES.INFO,\r\n    config: LogConfigType = {\r\n      color: getDefOptions().themeColor,\r\n      bgColor: getDefOptions().bgColor\r\n    }\r\n  ) {\r\n    let bgColor = config.bgColor\r\n    // 警告色不能改变\r\n    if (type === 2) bgColor = '#fffbe5'\r\n    // 错误色不能改变\r\n    if (type === 3) bgColor = '#fff0f0'\r\n    let style = `\r\n      background:${bgColor};\r\n      font-size:14px;\r\n      color:${config.color};\r\n      border: 1px solid;`\r\n    console.log(`%c web-loading:${message} `, style)\r\n  }\r\n}\r\n/**\r\n * 判空\r\n * @param value 判断值\r\n * @returns boolean\r\n */\r\nexport function isNull(value: any): value is null | undefined {\r\n  return value === undefined || value === null\r\n}\r\n/**\r\n * 清空 aniamtions\r\n * @param id\r\n */\r\nexport function clearAnimationFrame(id: number) {\r\n  if (!window.requestAnimationFrame) {\r\n    window.clearInterval(id)\r\n  } else {\r\n    window.cancelAnimationFrame(id)\r\n  }\r\n}\r\n", "import type { ElementStoreType, OptionsType } from '../types'\r\nimport { $Log } from '../utils'\r\nimport models from './model'\r\nexport default function drawController(\r\n  w: number,\r\n  h: number,\r\n  canvas: HTMLCanvasElement,\r\n  options: Required<OptionsType>,\r\n  store: ElementStoreType\r\n) {\r\n  try {\r\n    let model = null\r\n    // if (!options.custom) model = new (models[options.model] as any)(w, h, canvas, options, store.element.$store)\r\n    if (!options.custom) {\r\n      import(`./model/${options.model}.ts`).then((model) => {\r\n        new model.default(w, h, canvas, options, store.element.$store)\r\n      })\r\n    } else model = new options.custom(w, h, canvas, options, store.element.$store)\r\n    store.model = model\r\n  } catch (e) {\r\n    $Log.error('draw error(' + e + ')')\r\n  }\r\n}\r\n", "export default `\r\n@keyframes wl_show {\r\n  0% {\r\n    opacity: 0;\r\n  }\r\n  100% {\r\n    opacity: 1;\r\n  }\r\n}\r\n`\r\n", "import type { ElementType, OptionsType } from '../types'\r\nimport { LOADING_TYPES, getDefOptions, clearAnimationFrame, $Log } from '../utils'\r\nimport MiniLoading from '../ExtendLoading/index'\r\nimport drawController from '../draw/index'\r\nimport style from './style'\r\nexport default class WebLoading {\r\n  // 动画canvas\r\n  canvas: HTMLCanvasElement\r\n  // 动画元素id\r\n  loadingId: string | null\r\n  // 动画元素\r\n  element: ElementType\r\n  // 配置options\r\n  options: Required<OptionsType>\r\n  // extendLoading\r\n  extendLoading: MiniLoading | undefined\r\n  constructor(element: HTMLElement, options?: OptionsType, extendLoading?: MiniLoading) {\r\n    // 初始化默认配置\r\n    this.options = Object.assign(getDefOptions(), options)\r\n    this.extendLoading = extendLoading\r\n    this.canvas = document.createElement('canvas')\r\n    this.loadingId = String('wl_' + Date.now())\r\n    this.element = element\r\n    // 初始化储存属性\r\n    this.initStore()\r\n    this.init()\r\n  }\r\n  resize() {\r\n    this.canvas.width = this.element.clientWidth\r\n    this.canvas.height = this.element.clientHeight\r\n    this.draw()\r\n  }\r\n  close() {\r\n    let op = this.options\r\n    this.clearStyle()\r\n    this.loadingId = null\r\n    if (!op.pointerEvents) {\r\n      if (op.type === LOADING_TYPES.DOM) this.element.style.pointerEvents = 'auto'\r\n      else document.body.style.pointerEvents = 'auto'\r\n    }\r\n    // 清空mini影响样式\r\n    if (op.type !== LOADING_TYPES.DOM) this.extendLoading?.clearStyle()\r\n    if (this.element.$store) {\r\n      // 清除model\r\n      this.element.$store.model = null\r\n      // 关闭前回调\r\n      this.element.$store.hookCall.beforeColse()\r\n    }\r\n    // 清空dom\r\n    setTimeout(() => {\r\n      // 停止 animationFrame\r\n      if (this.element.$store?.animationId) clearAnimationFrame(this.element.$store?.animationId)\r\n      // 如果是min，清空父元素(父元素是webLoading创建)\r\n      if (op.type !== LOADING_TYPES.DOM) this.extendLoading?.getElement().remove()\r\n      else this.canvas.remove()\r\n      // 关闭后回调\r\n      if (this.element.$store?.hookCall) this.element.$store.hookCall.colsed()\r\n    }, op.delayColse)\r\n  }\r\n\r\n  private init() {\r\n    // 初始化样式\r\n    this.initStyle()\r\n    // 默认启动\r\n    this.draw()\r\n  }\r\n  private clearStyle() {\r\n    // 先视觉过渡\r\n    this.canvas.style.opacity = '0'\r\n    this.canvas.style.zIndex = '-2001'\r\n  }\r\n  private initStyle() {\r\n    let op = this.options\r\n    // offset 含有scroll值的 显然client:内容+padding更合理\r\n    let elementW = this.element.clientWidth,\r\n      elementH = this.element.clientHeight,\r\n      readElementStyle = window.getComputedStyle(this.element),\r\n      elementStyle = this.element.style,\r\n      canvasStyle = this.canvas.style\r\n    // 初始化元素的样式\r\n    this.element.loadingId = this.loadingId\r\n    if (!op.pointerEvents) {\r\n      if (op.type === LOADING_TYPES.DOM) this.element.style.pointerEvents = 'none'\r\n      else document.body.style.pointerEvents = 'none'\r\n    }\r\n    if (!readElementStyle.position || readElementStyle.position === 'static') elementStyle.position = 'relative'\r\n    // 初始化canvas样式\r\n    this.canvas.id = this.loadingId!\r\n    document.styleSheets[0].insertRule(style)\r\n    this.canvas.style.animation = `wl_show ${op.delayColse / 1000}s linear`\r\n    canvasStyle.position = 'absolute'\r\n    canvasStyle.left = `${op.pointerEvents ? 0 : this.element.scrollLeft}px`\r\n    canvasStyle.top = `${op.pointerEvents ? 0 : this.element.scrollTop}px`\r\n    canvasStyle.zIndex = op.zIndex\r\n    canvasStyle.transition = `${op.delayColse / 1000}s`\r\n    canvasStyle.backgroundColor = op.bgColor\r\n    canvasStyle.borderRadius = readElementStyle.borderRadius\r\n    // 设置画布大小\r\n    this.canvas.width = elementW\r\n    this.canvas.height = elementH\r\n    // 注入\r\n    this.element.append(this.canvas)\r\n  }\r\n  private draw() {\r\n    let w = this.canvas.offsetWidth,\r\n      h = this.canvas.offsetHeight\r\n    if (this.element.$store) {\r\n      drawController(w, h, this.canvas, this.options, this.element.$store)\r\n    } else {\r\n      $Log.error('WebLoading:canvas or ctx null')\r\n    }\r\n  }\r\n  private initStore() {\r\n    // 储存状态\r\n    this.element.$store = {\r\n      options: this.options,\r\n      element: this.element,\r\n      animationId: undefined,\r\n      loadingId: this.loadingId,\r\n      model: null,\r\n      hookCall: {\r\n        beforeColse: () => {},\r\n        colsed: () => {}\r\n      }\r\n    }\r\n  }\r\n}\r\n", "import WebLoading from './Webloading/index'\r\nimport type { OptionsType } from './types.d'\r\nimport { LOADING_TYPES } from './utils'\r\nexport default function loading(dom: HTMLElement, options?: OptionsType) {\r\n  // 默认调用\r\n  let webLoading = new WebLoading(dom, options)\r\n  const resize = () => {\r\n    webLoading.resize()\r\n  }\r\n  const reload = (options?: OptionsType) => {\r\n    // 保留上次传入参数\r\n    let op = Object.assign(webLoading.options, options)\r\n    // 防止重复注册\r\n    if (!webLoading.loadingId) {\r\n      if (op.type !== LOADING_TYPES.DOM) {\r\n        op = Object.assign(op)\r\n      }\r\n      webLoading = new WebLoading(dom, op)\r\n    }\r\n  }\r\n  const close = () => {\r\n    webLoading.close()\r\n  }\r\n  return {\r\n    reload,\r\n    resize,\r\n    close\r\n  }\r\n}\r\n"],
  "mappings": "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",
  "names": ["model", "_a", "options"]
}
